chrome.runtime.onMessage.addListener((e,o,s)=>{e.type==="TOGGLE_SELECTION_MODE"&&a(e.enabled)});let d=!1,t=null;function a(e){d=e,e?(document.body.style.cursor="crosshair",f(),document.addEventListener("mousedown",c),document.addEventListener("mousemove",r),document.addEventListener("mouseup",u)):(document.body.style.cursor="default",v(),document.removeEventListener("mousedown",c),document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",u))}function f(){t=document.createElement("div"),t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.zIndex="999999",t.style.pointerEvents="none",document.body.appendChild(t)}function v(){t&&(t.remove(),t=null)}let i=0,l=0;function c(e){d&&(e.preventDefault(),i=e.clientX,l=e.clientY)}function r(e){if(!d||!t)return;const o=e.clientX,s=e.clientY,m=Math.abs(o-i),h=Math.abs(s-l),y=Math.min(o,i),p=Math.min(s,l);let n=document.getElementById("copiedcatz-selection-box");n||(n=document.createElement("div"),n.id="copiedcatz-selection-box",n.style.position="absolute",n.style.border="2px solid #00ff00",n.style.backgroundColor="rgba(0, 255, 0, 0.2)",n.style.pointerEvents="none",t.appendChild(n)),n.style.width=`${m}px`,n.style.height=`${h}px`,n.style.left=`${y}px`,n.style.top=`${p}px`}function u(e){if(!d)return;const o=e.clientX,s=e.clientY;chrome.runtime.sendMessage({type:"AREA_SELECTED",area:{x:Math.min(i,o),y:Math.min(l,s),width:Math.abs(o-i),height:Math.abs(s-l)}}),a(!1)}
